<!DOCTYPE html>
<html>
<head>
  <title>Admin Upload ‚Äì 5th Semester</title>
</head>
<body style="background-color: black; color: white; font-family: Arial; padding: 20px;">
  <h1>üì§ Admin Upload ‚Äì 5th Semester</h1>
  <div id="upload-area"></div>
  <p id="uploadStatus"></p>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA9aYpmvxcXJbBPBUJv0-dSlB-3KfCmMg4",
      authDomain: "th-semester-files.firebaseapp.com",
      projectId: "th-semester-files",
      storageBucket: "th-semester-files.appspot.com",
      messagingSenderId: "233173657118",
      appId: "1:233173657118:web:f89131aaf75cefdf13700f"
    };

    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    const subjects = [
      "FiniteElementMethod",
      "DesignOfMachineElements",
      "HeatTransfer",
      "OperationResearch",
      "MechanicalMeasurementControl",
      "IndustrialAutornationRobotics",
      "IARLab",
      "MMCLab",
      "HeatTransferLab",
      "TrainingII",
      "Mentoring"
    ];

    const uploadArea = document.getElementById("upload-area");

    function createUploadSection(subject) {
      const section = document.createElement("div");
      section.style.marginBottom = "40px";
      section.innerHTML = `
        <h2>üìÅ ${subject.replace(/([A-Z])/g, ' $1')}</h2>
        <label>PDF: <input type="file" accept="application/pdf" onchange="uploadFile(this, '${subject}')"></label><br><br>
        <label>Image: <input type="file" accept="image/*" onchange="uploadFile(this, '${subject}')"></label><hr>
      `;
      uploadArea.appendChild(section);
    }

    window.uploadFile = function (input, folder) {
      const file = input.files[0];
      if (!file) return;

      const storageRef = ref(storage, `${folder}/${Date.now()}-${file.name}`);
      const uploadTask = uploadBytesResumable(storageRef, file);

      uploadTask.on('state_changed',
        (snapshot) => {
          const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
          document.getElementById("uploadStatus").innerText = `Uploading ${file.name}: ${progress.toFixed(0)}%`;
        },
        (error) => {
          alert("‚ùå Upload failed: " + error.message);
        },
        () => {
          getDownloadURL(uploadTask.snapshot.ref).then((url) => {
            document.getElementById("uploadStatus").innerText = `‚úÖ Uploaded: ${file.name}`;
          });
        }
      );
    };

    subjects.forEach(createUploadSection);
  </script>
</body>
</html>
